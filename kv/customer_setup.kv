<CustomerSetupScreen>:
    name: 'customer_setup'
    first_name_input: first_name_input
    last_name_input: last_name_input
    email_input: email_input
    phone_input: phone_input
    city_input: city_input
    address_input: address_input
    description_input: description_input
    customer_list: customer_list
    sensor_code_input: sensor_code_input
    sensor_description_input: sensor_description_input
    voltage_sensor: voltage_sensor
    flowmeter_sensor: flowmeter_sensor
    temperature_sensor: temperature_sensor
    ampermeter_sensor: ampermeter_sensor
    sensor_chart: sensor_chart

    GridLayout:
        padding: 10
        spacing: 10
        cols:3
        canvas.before:
            # Load and scale the background image to fit the screen
            Rectangle:
                source: root.bg_image
                pos: self.pos
                size: self.size
        # Foreground content over the background image
        BoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.7  # Occupy 1/3 of the screen width
            pos_hint: {'x': 0}
            padding: 5
            canvas.before:
                Color:
                    rgba: 0, 0, 0, 0.37
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [15,]
            # Title
            BoxLayout:
                size_hint_y: 0.1
                Label:
                    size_hint_x: .5
                    text: "New Customer"
                    bold: True
                    halign: "center"
                    valign: "middle"
                    font_size: self.width / 12
            # Customer Registration Form
            BoxLayout:
                orientation: 'vertical'
                size_hint_x: 0.9
                pos_hint: {'center_x': 0.5, 'top': .9}
                # Name & Last Name
                BoxLayout:
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .11

                    BoxLayout:
                        orientation: 'vertical'
                        Label:
                            size_hint_x: .4
                            text: "*Name"
                            bold: False
                            halign: "left"
                            valign: "middle"
                            font_size: self.width / 4
                        TextInput:
                            write_tab: False
                            size_hint_x: .6
                            id: first_name_input
                            font_size: self.height * 0.45
                    BoxLayout:
                        orientation: 'vertical'
                        Label:
                            size_hint_x: .4
                            text: "*Last Name"
                            bold: False
                            halign: "left"
                            valign: "middle"
                            font_size: self.width / 4
                        TextInput:
                            write_tab: False
                            size_hint_x: 1
                            id: last_name_input
                            font_size: self.height * 0.45
                # Email
                BoxLayout:
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .07
                    Label:
                        size_hint_x: .2
                        text: "*Email"
                        bold: False
                        halign: "left"
                        valign: "middle"
                        font_size: self.width / 4.2
                    TextInput:
                        write_tab: False
                        size_hint_x: .7
                        id: email_input
                        font_size: self.height * 0.45
                # Phone        
                BoxLayout:
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .07
                    Label:
                        size_hint_x: .2
                        text: "Phone"
                        bold: False
                        halign: "left"
                        valign: "middle"
                        font_size: self.width / 4.2
                    TextInput:
                        write_tab: False
                        size_hint_x: .7
                        id: phone_input
                        font_size: self.height * 0.45

                # City
                BoxLayout:
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .07
                    Label:
                        size_hint_x: .2
                        text: "City"
                        bold: False
                        halign: "left"
                        valign: "middle"
                        font_size: self.width / 4.2
                    TextInput:
                        write_tab: False
                        size_hint_x: .7
                        id: city_input
                        font_size: self.height * 0.45

                # Address
                BoxLayout:
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .07
                    Label:
                        size_hint_x: .2
                        text: "Address"
                        bold: False
                        halign: "left"
                        valign: "middle"
                        font_size: self.width / 4.2
                    TextInput:
                        write_tab: False
                        size_hint_x: .7
                        id: address_input
                        font_size: self.height * 0.45
                # Note
                BoxLayout:
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .15 
                    Label:
                        size_hint_x: .2
                        text: "Note"
                        bold: False
                        halign: "left"
                        valign: "top"
                        font_size: self.width / 4.2
                    TextInput:
                        write_tab: False
                        size_hint_x: .7
                        size_hint_y: 1
                        id: description_input
                        font_size: self.height * 0.15
                # Register Button
                BoxLayout:
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .1  
                    Label:
                        size_hint_x: .4
                        text: ""
                        bold: False
                        halign: "left"
                        valign: "middle"
                        font_size: min(root.width * 0.05, 18)
                    Button:
                        size_hint_x: .5
                        size_hint_y: 1
                        text: 'Register Customer'
                        font_size: self.width / 12
                        on_release: root.register_customer()
                        pos_hint: {"x": 1}
                # Delete a Customer
                BoxLayout:
                    id: btn_delete_customer
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .1
                    Label:
                        size_hint_x: .5
                        text: ""
                    Button:
                        font_size: self.width / 12
                        on_release: root.delete_a_customer()
                        text: "Delete Customer"
                        size_hint_x: .5
                # Back to Main menu
                BoxLayout:
                    padding: 5
                    spacing: 10
                    orientation: 'horizontal'
                    size_hint_y: .3
                    Button:
                        font_size: self.width / 12
                        on_release: root.manager.current = 'first_menu'
                        text: "Back to Main Menu"
                        size_hint_x: .5
                        size_hint_y: 0.28
                    Label:
                        size_hint_x: .5
                        text: ""

        #---------------------------------------------- # Customer List # ----------------------------------------
        BoxLayout:
            padding : 15
            spacing : 10
            orientation: 'vertical'
            size_hint_x: .6
            size_hint_y: 1
            canvas.before:
                Color:
                    rgba: 0, 0, 0, 0.37
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [15,]
            # Title Search
            BoxLayout:
                size_hint_y: .15
                orientation: 'horizontal'
                padding:5
                spacing:5
                Label:
                    size_hint_x: .5
                    text: "Customers"
                    bold: True
                    halign: "center"
                    valign: "middle"
                    font_size: self.width / 5
                TextInput:
                    write_tab: False
                    size_hint_x: .6
                    id: filter
                    font_size: self.height * 0.45
                    on_text: root.filter_customer_list(self.text)

            # Customer View
            ScrollView:
                canvas.before:
                    Color:
                        rgba: 0.95, 0.95, 0.95, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [15,]

                BoxLayout:
                    id: customer_list
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height

            # Sensor View        
            ScrollView:
                size_hint: (1, 1)    
                BoxLayout:
                    id: sensor_chart
                    orientation: 'vertical'
                    padding: (45,0,90,0)
                    size_hint_y: .99
            Label:
                size_hint_y: .1
                text:'' # empty space

        #------------------------------------------------# Sensor Setup Form #----------------------------------------
        BoxLayout:
            # Wrapper for the Sensor Setup Form with background image
            size_hint_x: 0.7
            padding: 5
            canvas.before:
                Color:
                    rgba: 0, 0, 0, 0.37
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [15,]

            BoxLayout:     
                orientation: 'vertical'
                padding: 1
                spacing: 1
                Image:
                    size_hint_y: 3.5
                    source: root.label_sensor_list
                    pos_hint: {"x": -0.28}

                Image:
                    size_hint_y: 0.7
                    source: root.label_sensor_code
                    pos_hint: {"x": -0.35}

                TextInput:
                    write_tab: False
                    id: sensor_code_input
                    size_hint_y: 0.7
                    size_hint_x: 0.9
                    multiline: False

                Image:
                    size_hint_y: 0.7
                    source: root.label_description
                    pos_hint: {"x": -0.35}

                TextInput:
                    write_tab: False
                    id: sensor_description_input
                    size_hint_y: 2
                    size_hint_x: 0.9
                    multiline: True

                Image:
                    size_hint_y: 0.7
                    source: root.label_sensor_type
                    pos_hint: {"x": -0.35}

                BoxLayout: 
                    size_hint_y: 2.5  # Sensors images
                    orientation: 'horizontal'
                    spacing: 5
                    padding: 5

                    BoxLayout:
                        orientation: 'vertical'
                        Image:
                            source: root.sensor1_image
                        CheckBox:
                            on_active: root.sensors_type(self,  self.active, "voltmeter")
                            id: voltage_sensor
                            group: 'sensor'

                    BoxLayout:
                        orientation: 'vertical'
                        Image:
                            source: root.sensor2_image
                        CheckBox:
                            on_active: root.sensors_type(self,  self.active, "flowmeter")
                            id: flowmeter_sensor
                            group: 'sensor'

                    BoxLayout:
                        orientation: 'vertical'
                        Image:
                            source: root.sensor3_image
                        CheckBox:
                            on_active: root.sensors_type(self,  self.active, "temperature")
                            id: temperature_sensor
                            group: 'sensor'

                    BoxLayout:
                        orientation: 'vertical'
                        Image:
                            source: root.sensor4_image
                        CheckBox:
                            on_active: root.sensors_type(self,  self.active, "ampermeter")
                            id: ampermeter_sensor
                            group: 'sensor'

                BoxLayout:
                    size_hint_y: 1.4
                    padding: [130 - self.width * 0.05, 0, 0, 0]  
                    Button:
                        size_hint_x: 0.2
                        text: "Save Sensor"
                        font_size: self.width / 14
                        background_normal: root.button_bg_normal
                        background_down: root.button_bg_down
                        on_release: root.save_sensor()
